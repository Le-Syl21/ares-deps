sdl_name='SDL3'
sdl_version='3.4.0'
sdl_url='https://github.com/libsdl-org/SDL.git'

sdl_setup() {
  echo "[SDL3] cloning"
  git clone --branch release-${sdl_version} --depth 1 ${sdl_url} SDL
  echo "[SDL3] cloning -- success"
}

sdl_package_source() {
  echo "[SDL3] packaging source"
  mkdir -p ../ares-deps-source/src/SDL/
  cp -R SDL/. ../ares-deps-source/src/SDL
  echo "[SDL3] packaging source -- success"
}

sdl_patch() {
  echo "[SDL3] patching -- skipped"
}

sdl_build() {
  echo "[SDL3] building"
  cd SDL
  cmake -B build \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX="$SCRIPT_DIR/ares-deps" \
    -DSDL_SHARED=ON \
    -DSDL_STATIC=OFF \
    -DSDL_TEST=OFF \
    -DSDL_X11_XTEST=OFF
  cmake --build build --parallel
  cd ..
  echo "[SDL3] building -- success"
}

sdl_install() {
  echo "[SDL3] installing"
  mkdir -p ares-deps/licenses/SDL3

  cmake --install build_temp/SDL/build

  cp build_temp/SDL/LICENSE.txt ares-deps/licenses/SDL3/LICENSE.txt

  echo "[SDL3] installing -- success"
}
